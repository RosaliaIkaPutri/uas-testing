<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Catatan Pembelian Batik Sederhana</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f4f9;
            color: #333;
        }
        .container {
            max-width: 1000px;
            margin: auto;
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #004d40;
            border-bottom: 2px solid #004d40;
            padding-bottom: 10px;
        }
        form, .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        .input-group input, .input-group button {
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
            flex-grow: 1;
            min-width: 150px;
        }
        button {
            background-color: #004d40;
            color: white;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #00695c;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        th {
            background-color: #e0f2f1;
            color: #004d40;
        }
        .total-row {
            background-color: #ccff90;
            font-weight: bold;
        }
        .action-btn {
            background-color: #d32f2f;
            padding: 5px 10px;
            margin: 2px;
        }
        .action-btn:hover {
            background-color: #c62828;
        }
        .edit-btn {
            background-color: #ffa000;
        }
        .edit-btn:hover {
            background-color: #fb8c00;
        }
    </style>
</head>
<body>

    <div class="container">
        <h2>Catatan Pembelian Produk Baju Batik</h2>
        <p>Sistem pencatatan sederhana dengan penyimpanan data sementara di browser (tidak butuh database).</p>

        <div class="input-group">
            <input type="text" id="namaProduk" placeholder="Nama Produk Batik" required>
            <input type="number" id="jumlah" placeholder="Jumlah" min="1" required>
            <input type="number" id="hargaSatuan" placeholder="Harga Satuan (Rp)" min="0" required>
            <input type="number" id="totalHargaOtomatis" placeholder="Total Harga (Otomatis)" disabled>
            <button onclick="tambahPembelian()">Tambahkan</button>
        </div>

        <hr>

        <h3>Daftar Pembelian</h3>
        <table>
            <thead>
                <tr>
                    <th>No.</th>
                    <th>Nama Produk</th>
                    <th>Jumlah</th>
                    <th>Harga Satuan (Rp)</th>
                    <th>Total Harga (Rp)</th>
                    <th>Aksi</th>
                </tr>
            </thead>
            <tbody id="tabelBody">
                </tbody>
            <tfoot>
                <tr class="total-row">
                    <td colspan="4" style="text-align: right;">TOTAL KESELURUHAN PENGELUARAN:</td>
                    <td id="grandTotal">Rp 0</td>
                    <td></td>
                </tr>
            </tfoot>
        </table>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            muatData();
            document.getElementById('jumlah').addEventListener('input', hitungTotalOtomatis);
            document.getElementById('hargaSatuan').addEventListener('input', hitungTotalOtomatis);
        });

        function hitungTotalOtomatis() {
            const jumlah = parseFloat(document.getElementById('jumlah').value) || 0;
            const hargaSatuan = parseFloat(document.getElementById('hargaSatuan').value) || 0;
            const total = jumlah * hargaSatuan;
            document.getElementById('totalHargaOtomatis').value = formatRupiah(total);
        }

        function formatRupiah(angka) {
            const formatter = new Intl.NumberFormat('id-ID', {
                style: 'currency',
                currency: 'IDR',
                minimumFractionDigits: 0
            });
            return formatter.format(angka);
        }

        function getDataPembelian() {
            const data = localStorage.getItem('catatanPembelianBatik');
            return data ? JSON.parse(data) : [];
        }

        function simpanDataPembelian(data) {
            localStorage.setItem('catatanPembelianBatik', JSON.stringify(data));
        }

        function tambahPembelian() {
            const namaProduk = document.getElementById('namaProduk').value.trim();
            const jumlah = parseFloat(document.getElementById('jumlah').value);
            const hargaSatuan = parseFloat(document.getElementById('hargaSatuan').value);

            if (!namaProduk || isNaN(jumlah) || jumlah <= 0 || isNaN(hargaSatuan) || hargaSatuan < 0) {
                alert('Mohon isi semua kolom dengan benar.');
                return;
            }

            const dataPembelian = getDataPembelian();
            const totalHarga = jumlah * hargaSatuan;

            const newEntry = {
                id: Date.now(),
                namaProduk,
                jumlah,
                hargaSatuan,
                totalHarga
            };

            dataPembelian.push(newEntry);
            simpanDataPembelian(dataPembelian);
            muatData();

            document.getElementById('namaProduk').value = '';
            document.getElementById('jumlah').value = '';
            document.getElementById('hargaSatuan').value = '';
            document.getElementById('totalHargaOtomatis').value = '';
        }

        function muatData() {
            const dataPembelian = getDataPembelian();
            const tabelBody = document.getElementById('tabelBody');
            tabelBody.innerHTML = '';
            let grandTotal = 0;

            if (dataPembelian.length === 0) {
                tabelBody.innerHTML = '<tr><td colspan="6" style="text-align: center;">Belum ada data pembelian tercatat.</td></tr>';
            } else {
                dataPembelian.forEach((item, index) => {
                    const row = tabelBody.insertRow();
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${item.namaProduk}</td>
                        <td>${item.jumlah}</td>
                        <td>${formatRupiah(item.hargaSatuan)}</td>
                        <td>${formatRupiah(item.totalHarga)}</td>
                        <td>
                            <button class="action-btn edit-btn" onclick="editPembelian(${item.id})">Ubah</button>
                            <button class="action-btn" onclick="hapusPembelian(${item.id})">Hapus</button>
                        </td>
                    `;
                    grandTotal += item.totalHarga;
                });
            }

            document.getElementById('grandTotal').textContent = formatRupiah(grandTotal);
        }

        function hapusPembelian(id) {
            if (confirm('Yakin ingin menghapus catatan pembelian ini?')) {
                let dataPembelian = getDataPembelian();
                dataPembelian = dataPembelian.filter(item => item.id !== id);
                simpanDataPembelian(dataPembelian);
                muatData();
            }
        }

        function editPembelian(id) {
            let dataPembelian = getDataPembelian();
            const itemToEdit = dataPembelian.find(item => item.id === id);

            if (itemToEdit) {
                const newNama = prompt("Edit Nama Produk:", itemToEdit.namaProduk);
                const newJumlah = prompt("Edit Jumlah:", itemToEdit.jumlah);
                const newHargaSatuan = prompt("Edit Harga Satuan:", itemToEdit.hargaSatuan);

                if (newNama !== null && newJumlah !== null && newHargaSatuan !== null) {
                    const editedJumlah = parseFloat(newJumlah);
                    const editedHargaSatuan = parseFloat(newHargaSatuan);

                    if (editedJumlah > 0 && editedHargaSatuan >= 0) {
                        itemToEdit.namaProduk = newNama.trim();
                        itemToEdit.jumlah = editedJumlah;
                        itemToEdit.hargaSatuan = editedHargaSatuan;
                        itemToEdit.totalHarga = editedJumlah * editedHargaSatuan;
                        simpanDataPembelian(dataPembelian);
                        muatData();
                    } else {
                        alert("Jumlah harus lebih dari 0 dan Harga Satuan tidak boleh negatif.");
                    }
                }
            }
        }
    </script>

</body>
</html>
